#include <stdio.h> 
#include <math.h> 
#include "./include/k2c_include.h" 
#include "resnet20.h" 

float maxabs(k2c_tensor* tensor1, k2c_tensor* tensor2);
float test1_input_1_input_array[784] = {
+9.90000000e-01f,+9.90000000e-01f,+9.90000000e-01f,-1.00000000e+00f,+9.90000000e-01f,
-1.00000000e+00f,+9.90000000e-01f,+6.86458005e-01f,+9.90000000e-01f,+9.90000000e-01f,
-1.00000000e+00f,+9.90000000e-01f,-5.95615753e-01f,+9.37130830e-01f,+9.90000000e-01f,
+9.90000000e-01f,+7.14650606e-01f,-1.00000000e+00f,-1.00000000e+00f,-1.00000000e+00f,
+9.90000000e-01f,-3.51454469e-01f,+9.90000000e-01f,+9.90000000e-01f,-1.00000000e+00f,
+3.27259943e-01f,-1.00000000e+00f,+7.70788137e-01f,-1.00000000e+00f,-8.33504111e-01f,
+3.90505316e-01f,+8.32575475e-01f,+9.90000000e-01f,+9.90000000e-01f,-1.00000000e+00f,
-1.00000000e+00f,-1.00000000e+00f,-2.47899245e-01f,+9.90000000e-01f,+9.90000000e-01f,
-1.00000000e+00f,+7.44349026e-01f,+1.11970841e-01f,-1.00000000e+00f,-1.00000000e+00f,
-1.74226876e-01f,+8.25572876e-02f,-1.00000000e+00f,-1.00000000e+00f,+9.90000000e-01f,
+9.90000000e-01f,+9.90000000e-01f,+9.90000000e-01f,+7.45545442e-01f,+1.41421547e-01f,
+9.90000000e-01f,+9.24064970e-01f,-1.00000000e+00f,+2.38904609e-01f,-1.00000000e+00f,
+8.53640365e-01f,+9.90000000e-01f,+4.82830186e-01f,-5.36614713e-01f,-1.00000000e+00f,
+1.47302006e-01f,+9.90000000e-01f,-4.94701831e-01f,+1.46169520e-01f,+9.90000000e-01f,
-1.00000000e+00f,-1.00000000e+00f,-2.62584531e-01f,+9.90000000e-01f,-1.00000000e+00f,
+1.63321401e-01f,+9.90000000e-01f,-1.00000000e+00f,-1.00000000e+00f,+9.90000000e-01f,
-1.00000000e+00f,-1.00000000e+00f,+9.90000000e-01f,+8.07804581e-01f,-1.00000000e+00f,
-3.37049331e-01f,-1.00000000e+00f,+9.90000000e-01f,-1.00000000e+00f,+9.06836993e-01f,
+9.14572261e-01f,-1.00000000e+00f,+9.90000000e-01f,+7.74267446e-01f,-9.78866699e-02f,
-1.68913546e-01f,+8.20879578e-01f,-5.30182934e-01f,-4.90353672e-01f,+9.90000000e-01f,
+9.90000000e-01f,+8.50315282e-01f,+7.56158972e-01f,-1.00000000e+00f,+9.90000000e-01f,
+5.87034385e-01f,-4.49201332e-01f,-1.00000000e+00f,-1.00000000e+00f,+9.90000000e-01f,
+9.90000000e-01f,-3.76549641e-01f,-9.97204948e-01f,-9.06877139e-01f,+9.90000000e-01f,
+9.90000000e-01f,-1.00000000e+00f,+6.47201933e-01f,-1.00000000e+00f,+9.90000000e-01f,
-1.00000000e+00f,+9.90000000e-01f,-1.00000000e+00f,+9.01383375e-01f,+1.85218997e-01f,
-1.00000000e+00f,-2.39072979e-01f,-2.37116946e-01f,+2.67637930e-01f,-1.00000000e+00f,
+9.78044370e-01f,-2.16690251e-01f,+2.21171158e-01f,-1.00000000e+00f,+3.36397134e-01f,
+5.59355681e-01f,-1.00000000e+00f,-5.08655270e-01f,-2.67697033e-01f,-8.62137441e-02f,
+1.05363579e-01f,-1.13596674e-01f,-1.00000000e+00f,-1.00000000e+00f,-6.31235837e-01f,
+9.90000000e-01f,-3.75115703e-01f,+7.00064698e-01f,-1.00000000e+00f,-1.00000000e+00f,
-1.00000000e+00f,-1.00000000e+00f,-6.66225523e-01f,+9.90000000e-01f,-6.04702651e-01f,
-1.00000000e+00f,-1.00000000e+00f,+9.90000000e-01f,-1.00000000e+00f,-1.00000000e+00f,
+1.93989615e-01f,+9.90000000e-01f,+9.01949970e-01f,+8.49994277e-01f,+9.90000000e-01f,
+9.90000000e-01f,-1.81253728e-01f,+3.29002263e-03f,-1.00000000e+00f,+9.90000000e-01f,
-1.00000000e+00f,-1.00000000e+00f,+8.54480250e-01f,-5.91216889e-01f,+2.39045833e-01f,
-8.05343533e-01f,-7.11016197e-01f,-1.00000000e+00f,-2.07800679e-01f,+3.05642030e-01f,
-3.07372944e-01f,+9.90000000e-01f,-1.00000000e+00f,+4.70052061e-01f,+8.02443863e-01f,
+4.59679726e-01f,+9.05699446e-01f,-1.00000000e+00f,+9.90000000e-01f,+9.90000000e-01f,
+9.90000000e-01f,-9.09603166e-01f,-1.00000000e+00f,-4.57291342e-01f,-1.00000000e+00f,
+9.90000000e-01f,+9.34947396e-01f,+1.28902912e-01f,+7.07273850e-01f,+9.90000000e-01f,
+2.86402716e-01f,+9.90000000e-01f,-1.00000000e+00f,+9.90000000e-01f,+9.90000000e-01f,
+9.90000000e-01f,-8.13586630e-01f,-9.26948694e-01f,-1.00000000e+00f,-1.00000000e+00f,
-1.00000000e+00f,+9.90000000e-01f,-1.00000000e+00f,+9.90000000e-01f,-1.00000000e+00f,
+9.90000000e-01f,+9.90000000e-01f,-6.02391482e-01f,+2.01144110e-01f,-1.00000000e+00f,
-6.75420816e-02f,+4.99383529e-01f,+9.90000000e-01f,+9.90000000e-01f,-1.00000000e+00f,
+9.90000000e-01f,+9.90000000e-01f,-1.00000000e+00f,-7.92487833e-01f,-9.65133647e-01f,
-6.81205953e-01f,+9.90000000e-01f,+9.90000000e-01f,+8.04736660e-01f,+9.90000000e-01f,
-1.24352651e-01f,-1.00000000e+00f,-1.00000000e+00f,-5.21786118e-01f,-4.34532891e-01f,
+9.90000000e-01f,-6.78466524e-01f,-1.00000000e+00f,+9.90000000e-01f,-1.00000000e+00f,
+9.90000000e-01f,+9.90000000e-01f,+5.09692173e-01f,+3.32012122e-01f,-6.27719633e-01f,
+1.82506840e-01f,+9.90000000e-01f,-1.00000000e+00f,-1.00000000e+00f,+9.90000000e-01f,
+8.27729301e-01f,+9.90000000e-01f,-1.00000000e+00f,+9.90000000e-01f,+1.20466790e-01f,
-4.28564875e-01f,+8.88955281e-01f,+8.33221584e-01f,-1.00000000e+00f,-1.00000000e+00f,
-4.56261643e-01f,-5.10600466e-01f,-5.47820530e-01f,+9.23049648e-02f,-1.00000000e+00f,
+9.90000000e-01f,+6.62469667e-02f,+9.90000000e-01f,+6.63134689e-01f,-3.74485761e-01f,
-3.69727245e-01f,+9.90000000e-01f,-1.00000000e+00f,+7.20171907e-01f,+6.05105242e-01f,
-5.14301876e-01f,-2.37148439e-02f,-1.00000000e+00f,-1.00000000e+00f,-2.25995544e-01f,
+7.45946484e-01f,+7.88543009e-01f,-1.00000000e+00f,+6.20038643e-01f,-1.00000000e+00f,
+9.90000000e-01f,-4.26050868e-01f,+9.90000000e-01f,-1.00000000e+00f,+4.04842011e-01f,
-1.00000000e+00f,-1.00000000e+00f,-5.26374817e-01f,-1.00000000e+00f,-9.88301451e-01f,
+7.99533093e-01f,-1.00000000e+00f,-8.50431287e-01f,+9.90000000e-01f,-8.94645608e-01f,
-1.84745395e-01f,-1.00000000e+00f,-9.83075118e-01f,+9.90000000e-01f,-1.00000000e+00f,
+1.99364148e-01f,+9.90000000e-01f,+9.90000000e-01f,+7.35574737e-01f,-9.21816881e-01f,
-3.32657298e-01f,+9.90000000e-01f,+9.90000000e-01f,-1.00000000e+00f,-6.96142301e-01f,
-7.20316331e-02f,+8.73345314e-02f,-1.00000000e+00f,+2.07991564e-02f,+1.20828170e-01f,
-8.90909158e-01f,+9.90000000e-01f,-1.00000000e+00f,+2.98592705e-01f,-1.38170594e-01f,
+5.19359995e-01f,+9.90000000e-01f,+9.90000000e-01f,+9.90000000e-01f,-9.63123224e-01f,
-1.00000000e+00f,+5.53583371e-01f,+9.90000000e-01f,-1.00000000e+00f,+3.98452628e-01f,
+9.90000000e-01f,+7.11675230e-01f,-1.00000000e+00f,-1.00121638e-01f,-8.72987304e-01f,
-1.00000000e+00f,-1.00000000e+00f,+9.90000000e-01f,-1.00000000e+00f,+9.90000000e-01f,
-1.00000000e+00f,-9.50832860e-01f,+4.63247019e-01f,+9.90000000e-01f,-7.93450816e-01f,
-1.00000000e+00f,-7.99143197e-01f,+8.15048591e-01f,-1.00000000e+00f,+9.51944707e-01f,
+9.90000000e-01f,-9.37560391e-01f,+7.84552847e-01f,+9.90000000e-01f,-1.00000000e+00f,
+9.90000000e-01f,-4.80234044e-01f,-6.73616724e-01f,-1.00000000e+00f,-7.12141435e-01f,
-4.05200183e-01f,-5.62390212e-01f,+3.88226487e-01f,-8.16373568e-01f,+9.90000000e-01f,
-5.42773220e-01f,+9.90000000e-01f,+6.01026215e-01f,+9.90000000e-01f,+9.90000000e-01f,
-1.00000000e+00f,+7.25474585e-02f,+9.90000000e-01f,-9.44140382e-01f,+9.90000000e-01f,
+9.74805093e-01f,-1.00000000e+00f,-4.93474174e-01f,+4.94827021e-01f,+9.90000000e-01f,
-1.00000000e+00f,-3.02695144e-01f,-1.00000000e+00f,-1.00000000e+00f,+9.90000000e-01f,
+2.88006624e-01f,+9.90000000e-01f,+9.90000000e-01f,-7.92264896e-02f,-1.00000000e+00f,
-1.00000000e+00f,+9.55817444e-01f,+6.93709406e-01f,+8.75324800e-01f,+9.90000000e-01f,
-1.00000000e+00f,-1.00000000e+00f,-1.00000000e+00f,-1.00000000e+00f,-6.47863981e-01f,
-1.00000000e+00f,+9.90000000e-01f,+3.41134133e-01f,+2.78826326e-01f,+9.90000000e-01f,
+2.63324976e-01f,+4.11733907e-01f,-1.00000000e+00f,-1.00000000e+00f,-8.01127977e-01f,
-1.00000000e+00f,+2.33309317e-01f,-4.97283905e-01f,-1.00000000e+00f,-1.00000000e+00f,
-1.00000000e+00f,-1.06749681e-01f,-1.00000000e+00f,+6.97179070e-01f,-4.50288390e-01f,
-1.00000000e+00f,+9.90000000e-01f,-1.00000000e+00f,-1.00000000e+00f,+9.90000000e-01f,
-1.00000000e+00f,+9.90000000e-01f,-1.00000000e+00f,-6.67751491e-01f,+5.68874858e-01f,
-5.45850746e-01f,-1.00000000e+00f,+9.90000000e-01f,+3.79106136e-01f,-1.00000000e+00f,
-3.70790754e-01f,-1.00000000e+00f,-1.00000000e+00f,-6.89311092e-01f,+9.90000000e-01f,
-1.00000000e+00f,-1.00000000e+00f,-9.02874025e-01f,-7.81902494e-01f,-1.00000000e+00f,
-4.06446842e-01f,+9.62004994e-01f,-1.00000000e+00f,-1.00000000e+00f,+9.90000000e-01f,
+9.90000000e-01f,-2.10903120e-01f,+6.13506255e-01f,+5.37975965e-01f,-6.70992953e-01f,
-5.34081676e-01f,+9.90000000e-01f,-5.56586758e-01f,-1.00000000e+00f,-8.76419445e-01f,
-7.81002931e-01f,+9.68214705e-01f,-1.53581062e-01f,-9.82285438e-01f,-9.38634354e-01f,
+9.90000000e-01f,+9.90000000e-01f,-1.00000000e+00f,+9.90000000e-01f,-9.80110011e-01f,
+8.95873052e-01f,+9.90000000e-01f,-1.00000000e+00f,-2.00771736e-01f,-1.00000000e+00f,
+9.90000000e-01f,-1.00000000e+00f,-1.00000000e+00f,-1.04104812e-01f,-1.00000000e+00f,
-1.00000000e+00f,+6.34765139e-01f,+7.80606473e-01f,-4.35794429e-01f,+7.71517218e-01f,
-1.00000000e+00f,+3.73634717e-01f,+9.90000000e-01f,-9.23167844e-01f,-1.00000000e+00f,
+6.99052459e-01f,-1.00000000e+00f,+3.54595014e-01f,-3.45934336e-01f,+9.90000000e-01f,
-1.00000000e+00f,+9.90000000e-01f,+2.33717829e-02f,+9.90000000e-01f,-1.00000000e+00f,
+4.21372870e-01f,+9.90000000e-01f,+9.90000000e-01f,-1.00000000e+00f,+9.90000000e-01f,
-1.00000000e+00f,-1.00000000e+00f,+9.90000000e-01f,-4.27623086e-01f,-1.00000000e+00f,
+9.90000000e-01f,-1.00000000e+00f,-1.00000000e+00f,-2.74196359e-01f,-1.00000000e+00f,
+7.55939626e-01f,-8.49540991e-01f,+9.90000000e-01f,+9.90000000e-01f,+9.90000000e-01f,
-5.07371521e-01f,+9.90000000e-01f,-1.00000000e+00f,-1.00000000e+00f,-2.99030957e-01f,
-1.00000000e+00f,-1.00000000e+00f,+9.90000000e-01f,-1.65459417e-01f,+4.87216178e-01f,
+9.90000000e-01f,+5.30861924e-01f,-7.42644327e-01f,-1.00000000e+00f,+4.32939402e-01f,
-1.00000000e+00f,-1.36591637e-01f,-1.00000000e+00f,+2.29752972e-01f,-1.00000000e+00f,
-1.74368627e-02f,+9.90000000e-01f,+9.90000000e-01f,-1.00000000e+00f,-1.00000000e+00f,
+7.33010956e-03f,+9.90000000e-01f,-9.15768557e-01f,-1.00000000e+00f,-1.00000000e+00f,
-5.84577416e-01f,-1.00000000e+00f,+2.23639454e-01f,+2.38641424e-01f,-9.13857611e-01f,
+6.37097964e-01f,+9.90000000e-01f,-1.83824052e-01f,+9.90000000e-01f,+9.90000000e-01f,
-1.00000000e+00f,+9.90000000e-01f,-8.83066232e-01f,-1.00000000e+00f,-1.00000000e+00f,
+9.90000000e-01f,+9.90000000e-01f,+9.90000000e-01f,+9.41255667e-01f,-2.27878992e-01f,
+7.00161871e-01f,-5.89101720e-01f,+9.90000000e-01f,-2.01909642e-01f,+9.90000000e-01f,
+9.90000000e-01f,-8.72736992e-01f,+9.90000000e-01f,+9.90000000e-01f,+9.33400001e-01f,
-1.00000000e+00f,-1.43501952e-01f,+2.84136032e-01f,-1.00000000e+00f,+3.91454345e-01f,
+9.51075698e-01f,-1.00000000e+00f,-1.00000000e+00f,-1.00000000e+00f,-1.00000000e+00f,
+9.90000000e-01f,-6.62710459e-01f,-1.00000000e+00f,+7.52039206e-01f,+8.53829410e-01f,
+8.04998807e-01f,+8.56966849e-02f,-9.04092413e-01f,-1.00000000e+00f,-1.00000000e+00f,
+9.90000000e-01f,-2.12645625e-01f,-1.00000000e+00f,+4.49045675e-01f,+2.58644679e-01f,
-1.00000000e+00f,+9.90000000e-01f,+9.90000000e-01f,+7.65996807e-02f,-8.32631422e-01f,
-5.66982310e-01f,-8.67397273e-01f,-1.00000000e+00f,-1.00000000e+00f,+9.90000000e-01f,
+3.31040193e-01f,-5.23727134e-01f,+9.05589892e-01f,-2.66592832e-01f,+3.44234985e-01f,
-1.00000000e+00f,+9.90000000e-01f,-1.00000000e+00f,-1.00000000e+00f,+1.12514898e-01f,
+9.90000000e-01f,-4.53666978e-01f,-7.97037687e-01f,+9.90000000e-01f,+9.90000000e-01f,
-1.59589229e-01f,-1.00000000e+00f,+9.90000000e-01f,+8.76442756e-01f,+2.87398175e-01f,
-6.50168934e-01f,+3.01989928e-02f,+4.70504663e-01f,+3.05846538e-01f,+3.58145147e-01f,
-4.01209807e-01f,+9.29873709e-01f,+9.90000000e-01f,-3.64004030e-03f,+8.61695827e-01f,
-1.00000000e+00f,+9.88798502e-02f,-3.93633949e-02f,-1.00000000e+00f,+7.03500256e-01f,
+9.42614968e-01f,+4.42061018e-01f,-1.26391592e-01f,-1.00000000e+00f,-1.00000000e+00f,
+2.81566646e-02f,-9.32475113e-01f,-1.00000000e+00f,-1.00000000e+00f,-8.02225216e-01f,
+9.90000000e-01f,-1.00000000e+00f,+7.32035245e-01f,-4.96392206e-01f,-1.00000000e+00f,
+3.30275177e-01f,-1.00000000e+00f,-2.69814803e-01f,+3.48955020e-01f,-5.29329609e-01f,
+7.06534491e-01f,-6.79125954e-01f,+1.43907561e-01f,-3.74689033e-01f,+9.90000000e-01f,
+9.90000000e-01f,-3.53510419e-01f,+9.90000000e-01f,+3.04790454e-01f,-1.00000000e+00f,
-9.80591355e-01f,+9.90000000e-01f,-7.90989351e-01f,-5.71546444e-01f,+6.84612644e-02f,
+9.90000000e-01f,+5.75886009e-01f,+9.90000000e-01f,-7.73868992e-01f,+7.83427741e-01f,
+7.35487338e-01f,-1.00000000e+00f,-1.33909122e-02f,-1.00000000e+00f,+9.90000000e-01f,
+1.41803859e-01f,-2.75076137e-01f,-4.66819914e-01f,-6.44596053e-02f,-1.00000000e+00f,
-1.00000000e+00f,-4.32732754e-01f,-1.61479949e-01f,+9.90000000e-01f,+9.90000000e-01f,
+8.69803430e-01f,+7.96255938e-01f,-3.59831185e-01f,+8.77170904e-01f,+9.90000000e-01f,
+9.90000000e-01f,-1.00000000e+00f,+9.90000000e-01f,-1.00000000e+00f,-2.64015490e-01f,
+5.58338109e-01f,+9.90000000e-01f,-1.00000000e+00f,+8.32748592e-01f,+9.26631624e-02f,
+9.90000000e-01f,-1.00000000e+00f,+5.17711636e-01f,-1.00000000e+00f,-6.32738330e-01f,
+9.19517903e-01f,-4.01826536e-01f,+9.90000000e-01f,-1.00000000e+00f,+9.90000000e-01f,
-1.00000000e+00f,+9.90000000e-01f,+6.04753218e-01f,+9.90000000e-01f,-1.00000000e+00f,
-5.97154063e-01f,+9.90000000e-01f,-9.39395396e-01f,-1.00000000e+00f,+9.90000000e-01f,
+9.90000000e-01f,-1.00000000e+00f,+9.90000000e-01f,+6.19366158e-01f,-1.00000000e+00f,
-1.10034185e-01f,+9.90000000e-01f,+9.90000000e-01f,-6.54735907e-01f,-1.00000000e+00f,
-1.00000000e+00f,-1.00000000e+00f,+2.77730234e-01f,-7.65833278e-01f,-6.79909414e-01f,
+3.48191858e-01f,+9.90000000e-01f,+9.90000000e-01f,-6.44566668e-01f,+6.10027292e-02f,
+6.68615314e-01f,+5.82816829e-01f,+9.90000000e-01f,-8.71593757e-01f,-1.00000000e+00f,
+9.90000000e-01f,+9.43748157e-02f,-1.00000000e+00f,+9.90000000e-01f,-1.00000000e+00f,
+6.20299955e-01f,+9.84985623e-01f,+3.61344813e-01f,+9.90000000e-01f, };
k2c_tensor test1_input_1_input = { &test1_input_1_input_array[0],3,784,{28,28, 1, 1, 1} };
float keras_dense_2_test1_array[10] = {
+0.00000000e+00f,+4.43636921e-16f,+4.35529044e-03f,+6.92123474e-19f,+4.38529812e-33f,
+9.95644689e-01f,+8.45747215e-31f,+3.39600076e-22f,+0.00000000e+00f,+0.00000000e+00f,
};
k2c_tensor keras_dense_2_test1 = { &keras_dense_2_test1_array[0],1,10,{10, 1, 1, 1, 1} };
float c_dense_2_test1_array[10] = { 0 };
k2c_tensor c_dense_2_test1 = { &c_dense_2_test1_array[0],1,10,{10, 1, 1, 1, 1} };
int main() {
    int8_t quant_test1_input_1_input_array[784] = { 0 };
    for (int i = 0; i < 784; i++) {
        quant_test1_input_1_input_array[i] = (128) * test1_input_1_input_array[i];
    }
    k2c_tensor test1_input_1_input = { &quant_test1_input_1_input_array[0],4,784,{ 1,28,28, 1} };
    float errors[1];
    size_t num_tests = 1;
    size_t num_outputs = 1;
    resnet20_initialize();
    resnet20(&test1_input_1_input, &c_dense_2_test1);

    errors[0] = maxabs(&keras_dense_2_test1, &c_dense_2_test1);
    float maxerror = errors[0];
    for (size_t i = 1; i < num_tests * num_outputs; i++) {
        if (errors[i] > maxerror) {
            maxerror = errors[i];
        }
    }
    printf("Max absolute error for 1 tests: %e \n", maxerror);
    resnet20_terminate();
    if (maxerror > 1e-05) {
        return 1;
    }
    return 0;
}

float maxabs(k2c_tensor* tensor1, k2c_tensor* tensor2) {

    float x = 0;

    float y = 0;

    for (size_t i = 0; i < tensor1->numel; i++) {

        y = fabsf(tensor1->array[i] - tensor2->array[i]);
        if (y > x) { x = y; }
    }
    return x;
}

